**Les informations ci-dessous sont une rapide introduction purement technique !
Consultez [www.logiciel-cabinet-medical.fr](http://www.logiciel-cabinet-medical.fr/) pour toutes les informations sur le logiciel MedShakeEHR !**

Un [groupe de discussion](https://groups.google.com/forum/#!forum/medshakeehr) est disponible pour les questions techniques.

# MedShakeEHR-base
Base pour MedShakeEHR, logiciel modulaire, universel, open source pour les praticiens santé.

## Avertissements
Ce logiciel ne doit pas être utilisé en l'état pour la stockage de données patient sur un réseau ouvert.  
Son utilisation doit être exclusivement limitée à un réseau privé sans utilisateur potentiellement hostile.
Il est livré ici sans aucune garantie, conformément à la licence GPL v3.

## Utilisation
MedShakeEHR-base constitue le coeur commun du logiciel. Il peut être accompagné de l'un ou l'autre de ses modules pour fonctionner de façon optimale.

## Installation
MedShakeEHR fonctionne sur un serveur xAMP. Il a été testé sous Ubuntu 16.04 / Mint 17.3 / Debian 9, Apache 2, PHP 7, Mysql 5 / MariaDB.

Utiliser [Composer](https://getcomposer.org/download/) à la racine pour l'installation des packages PHP nécessaires au back-end et dans public_html pour le front-end.

Le paramétrage de base (chemins, base de données) se fait à la première utilisation, et l'ensemble des paramètres est ensuite accessible par l'administrateur sur une page dédiée.
Chaque paramètre peut être surchargé au niveau utilisateur.  

La configuration complète du logiciel est documentée sur le site [www.logiciel-cabinet-medical.fr](http://www.logiciel-cabinet-medical.fr/) à la rubrique [Documentation technique](http://www.logiciel-cabinet-medical.fr/documentation-technique/).

# Docker Install / Installation Docker

WARNING : the generated docker config contain default password. You must change all the passwords before use.
ATTENTION : cette configuration docker contient des mots de passes par défaut. Vous devez changer tous les mots de passe avant l'utilisation.

1- Install Git and Docker, for instance with Ubuntu :
1- Installer GIT & Docker, par exemple sous Ubuntu :

>sudo apt install git docker.io docker-compose

2- Fetch/clone the desired version of EHR (here the latest):
2- Récupérer la version souhaitée de EHR (ici la dernière):

>git clone https://github.com/MedShake/MedShakeEHR-base.git

3- Enter the folder
3- Entrer dans le répertoire

>cd MedShakeEHR-base

4- Alter the following files to change password (MANDATORY), hostname or anything needed. Make sure that changes made are consistent accross the various files.
4- Modifier les fichiers suivants pour changer les mots de passe (OBLIGATOIRE), les noms de machines ou tout autre chose requise. Vérifiez que les changements effectués sont cohérents d'un fichier à l'autre.

- docker-compose.yml : MYSQL_ROOT_PASSWORD, MYSQL_USER, MYSQL_PASSWORD
- medshakeehr.conf : ServerName
- config/config.yml : host (=ServerName), cookieDomain, new fingerprint, sqlUser (=MYSQL_USER), sqlPass (=MYSQL_PASSWORD), new sqlVarPassword
- config/configuration.sql

5- Brand new fingerprint & sqlVarPassword can be generated by :
5- De nouveaux (new) fingerprint & sqlVarPassword peuvent être générés via :

> dd if=/dev/urandom bs=1 count=8 2>/dev/null | base64 -w 0

6- Build the required EHR images :
6- Construire les images de EHR :

> docker-ehr-build.sh

7- Launch the application (create + start)
7- Lancer l'application (create + start)

> docker-compose up

8- First time there will be an error trying to start the web container.
8- La première fois, une erreur va bloquer le lancement du conteneur web.
8- As a workaround for this issue launch :
8- Pour contourner cette difficulté, lancer :

> mkdir ~ehr/log/apache2

9- And restart compose :
9- Puis, relancer compose :

> docker-compose up

10- An EHR instance is ready :
10- Vous avez une instance de EHR de disponible :

>http://host/

Follow the instructions there ...
Y suivre les instructions ...



To start the containers
Pour démarrer les conteneurs

> docker-compose start

To remove the containers (this will not remove ~ehr/data)
Pour supprimer les conteneurs (ne supprime pas ~ehr/data)

> docker-compose rm

To list the containers :
Pour lister les conteneurs :

> docker-compose ps

From a terminal, access the "web" container's shell (here the db) :
Depuis un terminal, accèder à l'invite du conteneur "web" (ici le db)

> docker exec -it medshakeehrbase_db_1 /bin/bash
